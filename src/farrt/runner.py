import random
from matplotlib import pyplot as plt

import numpy as np
from farrt.PartiallyObservablePlanner import PartiallyObservablePlanner
from farrt.node import Node
from farrt.plot import plot_point, plot_world
from farrt.world import World


def main(Planner, *args, **kwargs):
  """
  The main function of the farrt package.

  Parameters
  ----------
  Planner : Planner
    The planner to use.
  *args : list
    The arguments to pass to the planner.
  **kwargs : dict
    The keyword arguments to pass to the planner.

  Returns
  -------
  None
  """
  OBSTACLE_STR = None#"MULTIPOLYGON (((4.975463609829284 45.22491861450658, 4.975463609829284 37.61151918890049, 0 37.61151918890049, 0 45.22491861450658, 4.975463609829284 45.22491861450658)), ((53.751974771284615 22.281117482663035, 49.12366408922094 22.281117482663035, 49.12366408922094 29.581682990503822, 48.037113905181194 29.581682990503822, 48.037113905181194 40.841043105928364, 48.50257698962987 40.841043105928364, 48.50257698962987 42.391197540579796, 48.69331498520387 42.391197540579796, 48.69331498520387 44.16663811524711, 57.22527542815868 44.16663811524711, 57.22527542815868 40.841043105928364, 59.296474020605736 40.841043105928364, 59.296474020605736 34.326551541135814, 68.05454120509992 34.326551541135814, 68.05454120509992 24.688264481541736, 65.55480116965047 24.688264481541736, 65.55480116965047 14.440531653748378, 64.3213143533801 14.440531653748378, 64.3213143533801 13.227293264289607, 69.60316688528106 13.227293264289607, 69.60316688528106 12.021002333725448, 75.3732087857855 12.021002333725448, 75.3732087857855 11.443530975900913, 77.60595445232606 11.443530975900913, 77.60595445232606 6.501188360798675, 75.3732087857855 6.501188360798675, 75.3732087857855 5.80431183038417, 69.15651828244421 5.80431183038417, 69.15651828244421 7.358742643851158, 63.73461626484261 7.358742643851158, 63.73461626484261 10.010497798112514, 61.627968133595964 10.010497798112514, 61.627968133595964 9.531844272911744, 52.43699108867626 9.531844272911744, 52.43699108867626 12.65344941137736, 46.95900256372349 12.65344941137736, 46.95900256372349 20.502178999778153, 53.751974771284615 20.502178999778153, 53.751974771284615 22.281117482663035), (58.416254145505846 26.243358052114232, 58.416254145505846 29.581682990503822, 57.53005111507274 29.581682990503822, 57.53005111507274 26.243358052114232, 58.416254145505846 26.243358052114232)), ((63.54927631892523 80.92147319637623, 63.54927631892523 78.51689675581282, 65.08267419893906 78.51689675581282, 65.08267419893906 82.87379490868308, 65.7893671048644 82.87379490868308, 65.7893671048644 83.46684810429004, 67.18857096219054 83.46684810429004, 67.18857096219054 89.96218213080746, 76.93079444553348 89.96218213080746, 76.93079444553348 88.8123979892342, 86.31989302384692 88.8123979892342, 86.31989302384692 88.16321597293236, 87.1684156982815 88.16321597293236, 87.1684156982815 92.26469296052932, 81.73839620432572 92.26469296052932, 81.73839620432572 99.75095003901993, 89.22465328281633 99.75095003901993, 89.22465328281633 94.39796489173298, 96.41122172980042 94.39796489173298, 96.41122172980042 91.216922352416, 100 91.216922352416, 100 77.72486447234554, 88.21067097775216 77.72486447234554, 88.21067097775216 78.59418456802561, 86.31989302384692 78.59418456802561, 86.31989302384692 76.85311477097011, 74.36060980558283 76.85311477097011, 74.36060980558283 80.21995864746452, 71.91045970705022 80.21995864746452, 71.91045970705022 77.34575550210421, 70.85541239831736 77.34575550210421, 70.85541239831736 77.10105670930479, 67.51577480400086 77.10105670930479, 67.51577480400086 71.81214702530563, 66.84581345040546 71.81214702530563, 66.84581345040546 70.06668958730612, 73.87641829942332 70.06668958730612, 73.87641829942332 62.92157077361694, 66.73129948573414 62.92157077361694, 66.73129948573414 68.15610725387295, 58.11366270990708 68.15610725387295, 58.11366270990708 71.09442727656345, 53.72223039911247 71.09442727656345, 53.72223039911247 72.50801788018057, 51.24397007117599 72.50801788018057, 51.24397007117599 79.89212553072485, 53.72223039911247 79.89212553072485, 53.72223039911247 80.92147319637623, 63.54927631892523 80.92147319637623)), ((5.655982646274307 21.37444530968945, 5.655982646274307 23.267961254784076, 14.765304541967454 23.267961254784076, 14.765304541967454 25.49033127555, 11.326666343029583 25.49033127555, 11.326666343029583 26.965286834072476, 8.804852819750309 26.965286834072476, 8.804852819750309 38.71503035695148, 20.554596342629317 38.71503035695148, 20.554596342629317 31.374759069860136, 25.572529334153426 31.374759069860136, 25.572529334153426 25.94079223960237, 24.048351141686176 25.94079223960237, 24.048351141686176 22.085284156945573, 20.128573093163226 22.085284156945573, 20.128573093163226 20.279725573556277, 16.275593318396062 20.279725573556277, 16.275593318396062 13.402483606782198, 16.998566833301318 13.402483606782198, 16.998566833301318 6.083614773050009, 17.57838913811507 6.083614773050009, 17.57838913811507 0, 10.241187652453695 0, 10.241187652453695 3.6712572429015413, 2.863091614623972 3.6712572429015413, 2.863091614623972 12.805161629685033, 5.602018185169815 12.805161629685033, 5.602018185169815 13.201517496077315, 5.655982646274307 13.201517496077315, 5.655982646274307 15.236436551553481, 2.962546844721583 15.236436551553481, 2.962546844721583 21.37444530968945, 5.655982646274307 21.37444530968945)), ((37.10363865870382 85.1646616398993, 46.10360217391416 85.1646616398993, 46.10360217391416 76.16469812468895, 40.959724249130076 76.16469812468895, 40.959724249130076 74.70345461536215, 34.91690396182325 74.70345461536215, 34.91690396182325 80.74627490266897, 37.10363865870382 80.74627490266897, 37.10363865870382 85.1646616398993)), ((40.803245026692004 94.31924350920694, 40.803245026692004 100, 49.6983184075848 100, 49.6983184075848 94.31924350920694, 40.803245026692004 94.31924350920694)), ((51.73754179472827 57.14983920196681, 47.04874224145125 57.14983920196681, 47.04874224145125 53.95485078013806, 35.576076342197695 53.95485078013806, 35.576076342197695 59.607005616934025, 33.681151721340676 59.607005616934025, 33.681151721340676 60.60678284527032, 25.51142093198076 60.60678284527032, 25.51142093198076 65.86559150133719, 19.104699849417152 65.86559150133719, 19.104699849417152 66.8864554381405, 12.903793341551705 66.8864554381405, 12.903793341551705 71.8749983433896, 12.119881193139083 71.8749983433896, 12.119881193139083 64.66830247126128, 16.436637102678542 64.66830247126128, 16.436637102678542 59.3814040378438, 11.149738669261064 59.3814040378438, 11.149738669261064 63.33530621155646, 8.451569525155676 63.33530621155646, 8.451569525155676 61.86209756218105, 6.559642002154655 61.86209756218105, 6.559642002154655 60.34929030550278, 8.809309087999644 60.34929030550278, 8.809309087999644 49.423536912822016, 8.71184973738522 49.423536912822016, 8.71184973738522 48.14764609025869, 0 48.14764609025869, 0 71.34450371663996, 2.8628739734705446 71.34450371663996, 2.8628739734705446 72.592313431225, 6.970275758084061 72.592313431225, 6.970275758084061 78.51569943379202, 13.610976848486473 78.51569943379202, 13.610976848486473 77.31727036425411, 19.195619198341607 77.31727036425411, 19.195619198341607 78.6176920677674, 29.549966986531604 78.6176920677674, 29.549966986531604 69.20693745910171, 33.681151721340676 69.20693745910171, 33.681151721340676 69.4437089035844, 39.204729981176804 69.4437089035844, 39.204729981176804 73.3999696830151, 46.05679502251002 73.3999696830151, 46.05679502251002 66.54790464168188, 43.51785500799105 66.54790464168188, 43.51785500799105 65.824234791776, 51.73754179472827 65.824234791776, 51.73754179472827 57.14983920196681)), ((67.7958827501633 99.26546005221455, 67.7958827501633 92.33090778024395, 62.13661764878445 92.33090778024395, 62.13661764878445 86.11249458612232, 54.63575264468385 86.11249458612232, 54.63575264468385 93.61335959022293, 60.8613304781927 93.61335959022293, 60.8613304781927 99.26546005221455, 67.7958827501633 99.26546005221455)), ((64.68012346576447 51.013636317305334, 64.68012346576447 59.70582216796078, 73.37230931641992 59.70582216796078, 73.37230931641992 51.013636317305334, 64.68012346576447 51.013636317305334)), ((79.59585349238989 50.698136250033, 75.41618916276718 50.698136250033, 75.41618916276718 58.95843131181884, 76.41683042867821 58.95843131181884, 76.41683042867821 62.12285369823376, 78.81750683402282 62.12285369823376, 78.81750683402282 68.11718370424964, 84.98919582118837 68.11718370424964, 84.98919582118837 72.14538499878623, 93.62493919387602 72.14538499878623, 93.62493919387602 63.50964162609859, 88.4026157067826 63.50964162609859, 88.4026157067826 59.397257815989484, 89.32156040639582 59.397257815989484, 89.32156040639582 51.97988766302613, 91.76934196741651 51.97988766302613, 91.76934196741651 44.09564114350674, 88.72610055760009 44.09564114350674, 88.72610055760009 44.01297460031977, 98.85218974520612 44.01297460031977, 98.85218974520612 33.787398792764186, 92.87002434173186 33.787398792764186, 92.87002434173186 31.60285918972297, 91.91373718326187 31.60285918972297, 91.91373718326187 25.620289824709104, 85.02554803265186 25.620289824709104, 85.02554803265186 20.15013691932551, 84.82397850293655 20.15013691932551, 84.82397850293655 18.55244966527199, 78.82621263719176 18.55244966527199, 78.82621263719176 14.950950477605328, 69.51120354592015 14.950950477605328, 69.51120354592015 24.26595956887692, 73.4941700665767 24.26595956887692, 73.4941700665767 31.681514885400667, 80.73966584192758 31.681514885400667, 80.73966584192758 32.888332966057185, 78.70785172773827 32.888332966057185, 78.70785172773827 34.86386562977198, 78.1867120601261 34.86386562977198, 78.1867120601261 42.48512150546436, 80.14690243526064 42.48512150546436, 80.14690243526064 46.11902307777054, 79.59585349238989 46.11902307777054, 79.59585349238989 50.698136250033)), ((40.24799893371426 44.26236921741602, 40.24799893371426 41.839164371195416, 44.93627484211951 41.839164371195416, 44.93627484211951 36.43540274333379, 40.24799893371426 36.43540274333379, 40.24799893371426 35.22400979270988, 31.20963950900811 35.22400979270988, 31.20963950900811 44.26236921741602, 40.24799893371426 44.26236921741602)), ((97.49624132922231 18.520805138720284, 97.49624132922231 18.756567597301743, 100 18.756567597301743, 100 4.973839181870297, 91.5835995591346 4.973839181870297, 91.5835995591346 15.387253360656665, 93.36460672389194 15.387253360656665, 93.36460672389194 17.841258392519638, 94.52067881711913 17.841258392519638, 94.52067881711913 18.520805138720284, 97.49624132922231 18.520805138720284)), ((40.80372775809701 8.68467696768107, 32.83092054174769 8.68467696768107, 32.83092054174769 11.735363098232451, 28.867695473138273 11.735363098232451, 28.867695473138273 18.407920084065214, 35.54025245897104 18.407920084065214, 35.54025245897104 16.657484184030395, 40.80372775809701 16.657484184030395, 40.80372775809701 8.68467696768107)), ((77.60273431568822 95.92496041446839, 77.60273431568822 90.939751114394, 72.61752501561384 90.939751114394, 72.61752501561384 92.9060817934656, 70.77614183830703 92.9060817934656, 70.77614183830703 98.0268670869894, 75.89692713183082 98.0268670869894, 75.89692713183082 95.92496041446839, 77.60273431568822 95.92496041446839)), ((70.66389786007231 3.7423557465316377, 70.66389786007231 0, 64.82517992046253 0, 64.82517992046253 3.7423557465316377, 70.66389786007231 3.7423557465316377)), ((37.37171696850819 6.814318696334228, 46.769536912337806 6.814318696334228, 46.769536912337806 0, 37.37171696850819 0, 37.37171696850819 6.814318696334228)), ((13.081815810456265 50.06619758370228, 17.109961249408137 50.06619758370228, 17.109961249408137 48.581202144244486, 19.841830270355022 48.581202144244486, 19.841830270355022 41.91241294574688, 13.173041071857416 41.91241294574688, 13.173041071857416 46.03805214475041, 13.081815810456265 46.03805214475041, 13.081815810456265 50.06619758370228)), ((86.03708658817496 5.363437344651262, 86.03708658817496 10.030450102155456, 90.70409934567914 10.030450102155456, 90.70409934567914 5.363437344651262, 86.03708658817496 5.363437344651262)), ((5.159351139180918 100, 12.694662086680504 100, 12.694662086680504 92.59932987532616, 5.159351139180918 92.59932987532616, 5.159351139180918 100)), ((21.221528198708114 11.176798740987994, 31.763650131267312 11.176798740987994, 31.763650131267312 0.6346768084288001, 21.221528198708114 0.6346768084288001, 21.221528198708114 11.176798740987994)), ((82.86779007914978 0, 76.43502462096257 0, 76.43502462096257 4.278311689617949, 82.86779007914978 4.278311689617949, 82.86779007914978 0)), ((14.962612597789592 80.75240329185789, 9.421448044536328 80.75240329185789, 9.421448044536328 86.29356784511114, 14.962612597789592 86.29356784511114, 14.962612597789592 80.75240329185789)), ((95.68210819628422 94.44698075817445, 95.68210819628422 100, 100 100, 100 94.44698075817445, 95.68210819628422 94.44698075817445)), ((53.14417752308468 55.06822302236022, 53.14417752308468 63.06275938302354, 61.138713883748 63.06275938302354, 61.138713883748 55.06822302236022, 53.14417752308468 55.06822302236022)), ((69.60842585774793 38.88243300315011, 60.09909888594186 38.88243300315011, 60.09909888594186 48.39175997495619, 69.60842585774793 48.39175997495619, 69.60842585774793 38.88243300315011)))"

  world = World(obstacle_str=OBSTACLE_STR)
  print(world.obstacles)

  start = world.random_position(not_blocked=False)#Point(99.25924832620859, 65.55707024255547)
  goal = world.random_position(not_blocked=False)#Point(36.34354864552062, 97.4867297995134)

  random.seed(1)
  np.random.seed

  if OBSTACLE_STR is None:
    fig,ax = plot_world(world)
    start = world.random_position(not_blocked=True)
    goal = world.random_position(not_blocked=True)
    plot_point(ax, start, marker=".", markersize=6, markeredgecolor="red", markerfacecolor="red")
    plot_point(ax, goal, marker=".", markersize=6, markeredgecolor="green", markerfacecolor="green")
    plt.show()

  print(f'Start: {start} -> Goal: {goal}')

  planner: PartiallyObservablePlanner = Planner(world=world, x_start=Node(start), x_goal=Node(goal), gui=True, **kwargs)
  planner.run()
  return None